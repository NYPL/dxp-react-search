language: node_js
node_js:
  - 14
services:
  - docker
cache:
  directories:
    - node_modules
branches:
  only:
    - qa
    - production
env:
  global:
    - REMOTE_IMAGE_URL_NYPL_DEV=491147561046.dkr.ecr.us-east-1.amazonaws.com/nypldxpsearch
    - REMOTE_IMAGE_URL_NYPL=463786892988.dkr.ecr.us-east-1.amazonaws.com/nypldxpsearch
    # Google Maps API
    #- secure: XDvANpolEs/OcEBFESqyM5OCtjbGVfIrpYZbNquHFz0JzUHUMNbj5CHtKuhGGOex19B3XZeGnUGutLc/zZ9EH/q8gYKnksU1tUdLino7N7GR6JV7sbAiehsBsWIis3+4lS7Jf8LsuSr7tWf8HCMryUNuWXt3vVvq+cx+aQ5brCzdrW34uZJkp4arAEedkA6I/TDcwZpXxTJuU4/1qRad0A5jk3KZupBwZLzggZPA7oEGdpmZVfONBe4C3ZJ0BrrjFAoXhvIhPGkOOKKCn03pX28DnGHnDj79GbIXd6iZlLr701l4K31EmRvPBwRJ4npGRbIww36eeytNpaiOxzPKFA52GP8nv6mNOUJlcW5mayhTHAxgpvt4kRTF04MtN6NFahuFgyk0sNQiR+mctiejm7YsUQNjuTtxZ8DOUV7ZfUoH1Hw/0aHUYWdmtk38j2zXk7/Zdx9YyScc+om05pL3nqN69rgjnVhBQckOm0JHPWltaRidhEV5clv4Tx7DiQl0vH/tSkGE4K6xnzZxv0xEHZpg3xc1rVMHOb69SSkRqlMJn8KIkGVFO7Ic1hVpXyocM0Xa1eZDIZCLB3Oq6/F8OdUJZ37Ie8+pUZUhXcYTA+9gdm4w2TJnAEkhL4PhJYCUS+S1+IoU6TzuLIjATJrH0uhKoWvF6S7/MN9dD8lG+KU=
    # AWS Dev
    - secure: zau/pq7kxpJ96K7yvXWEV4qIxyFnXkPTCtSVG6L2s28Cn4z8pjJvsoXkFkHzwuv2MbhLGZUOI+0oApWxVJhJX9lIz+/8bN0HRpESFl/FYiU4XYgbe1BcHRdaPB/jCHW/lx9be3lHjeEW6cVddVw571CnLvYZ0dfP2jY5JGqaQXVxr4M28Ou+wBoZS42UAJzWhnz7o8q+4nAdUO90jdPDnB5WDvxXRPfdr39RIEgmlvGwtXG01cv3JgmVfc5l3t1QFLQJJ0wKwyu827kLnugYUE//UO4Hw8NeQ61fvPCVb/ATGdriuj7WAOdaAzW41wdNOUddavtte1Jkn/gf7jMJ4mqZvU07asKSRZWZnmQcBsodKRvG8SZvd6Ny/PYNhqmE2EJ5oT6YFWZgJzc38FDXvmDEVAdLwYFE0eS4eXfPe/nTNBRCAdVEXEcQPd0WzKCu+ztGhx0Jkd/WrE6lYGK4JbYghpRwtBAIXDX+Fl+Wb/sUYExvKZ6tNiRgIRcmP1WNEBbsSEvIPinzPMNDyCImpXOXiUYFmlZ7rEtuT1CIKmqlbe88IZTbVqSmfRBYyTH1zk7qjrXkwxwF730zQvu2+V3VYtGPlucn0CMzpUkxQojVCjQokODIzI2Atnif7bjgVOeYPHweaoZ+xcmHyxMABM11PEkENN2HyjKGoyBVg0g=
    # AWS Prod
    - secure: OtCjdOOG1wl4K9EBjlvlfRcRMy2+KPbSqAwajD1EZva6K19P0kwKHgK2Wv0ZyHptZisERQmBdAvyBomf81JOw+WKWIzN25zxDvRIv8ePxcOf8cDqQbSEDpcj6V+UtX83w0g0w/Gp63CdWRPxqI9mpi3MSzwkWkJO3pjBXGZ/vZTZIm/Pl7S6NjzFRBuaQya9qTVFS2piKXNRchpZzWBLtopfvJgQpKfcMUHz6srrUxg7z6RhpqMh4VxOpLDNC+BH4us+kjOHRKpTLu2uKQLn6/x0k2IPrRgT0SfknFmHsVcZ4lzJn/ufpapfwMp/qBlZqmtgVwZuoTwnCzSa54HjolG8xBFLMLj1OTdbgmYLME6GV7Lj74Xs6ZARFMSaLpyH+GGQmKvq7ZGeqk+vKEMDeNrhoE3qmLRKT1qVH3e/9NBSQTSqerys66ZHnqg2joXccXNVWXMKw3QqRrZD2yEppscrdO3W32c7tFW3/sCKZL6VggzxwODaEzy6I2VL9r8/Ty4y6TqvzNSev/XjGFF///2rYJq2KlcmGdDnqv69EAXXXhaDN3ee/1TXaprbWov3JRgyUy+x2XoCce2Rh6HX/U2z02PWQtD0TTKpHwh9RYzJRmPyBvwWGnT+yw/1oMghTSXDcfVzxw1CCuiaOyNmOoZTSx1tYWn4hQz5zYFAbBc=
install: npm install
before_script:
  - cp .travis/.env .
  - "./provisioning/set-env"
after_success:
  - echo 'All tests passed; Preparing to deploy'
  - "./provisioning/deploy"
