language: node_js
node_js:
  - 14
services:
  - docker
cache:
  directories:
    - node_modules
branches:
  only:
    - qa
    - production
env:
  global:
    - REMOTE_IMAGE_URL_NYPL_DEV=491147561046.dkr.ecr.us-east-1.amazonaws.com/nypldxpsearch
    - REMOTE_IMAGE_URL_NYPL=463786892988.dkr.ecr.us-east-1.amazonaws.com/nypldxpsearch
    - secure: ZO7zmS6LKS84niwxMi92NakdMnuent35z1uIlIcWWChhbCQf4biyuN2BdMSAEIv0VvsrrJW98kpkFr4PU7Un+HxUplueSZ4Z/iU0A7vyDEE7PgDdS/Nw7IZHso0QmXEuWwVBXlbSdey1fHHK7Hx3/yE5Ol/qBqX4rEKQEJE1zrytMcR2LjbDZSyiSONu21KsqvKf8dTpqdyzrqXWvTZZNqpSUXicDiLoKgSAijBo/hYg0W55u77J5qNyxvKAlSpZD0cibNUex/6vSW2Nke0FOiMYay0fa1qPn85KRRPiRsA5pM27cJPGimPrhhuPFdCj4Ts6LGPnR6oP6TrvO9UqoTG90ht+4fQ1TD2n8OfZ+/G0le/wj38LIqt9OIULXzEe4aXLVd7pEgeXFewsvZW42Fz+Buar67gJz4tagnrljJlTZm4tAjVOwJpYgCE18jZnoMcexZuLgMIoN9S8OzV1JXlnPSSD8O0974yetoxlrgdRjCQgKVTaFcqWmLCzKx03CLE3eHjQkxymlV+l3XPS4VTNrlOeB14TSLHJubw7krDfSvy4ztkt4Z8jmbweFFsvq+M9rYzZkx9a3RN2Uj26mA85qPwNFprcevWEuDu0plteEL595sR8cLZVkPprcfrONYtUBvSEvvTCDQB/m4mXTsbDzxD3pWitXbCQWnNR1gI=
install: npm install
before_script:
  - cp .travis/.env .
  - "./provisioning/set-env"
after_success:
  - echo 'All tests passed; Preparing to deploy'
  - "./provisioning/deploy"
